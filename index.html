<html>
<head>
<title>Render Loader</title>
<script src="./jquery-1.11.3.min.js" charset="utf-8"></script>
<script>
// http://stackoverflow.com/a/133997
// http://stackoverflow.com/a/13038218
// Post to the provided URL with the specified parameters.
var count = 0;
var testImage = {
  'id': 'test01',
  'ambient': 0.1,
  'gammaCorrection': 1/2.2,
  'dim_x': 500,
  'dim_y': 500,
  'lightSource': {'x':-10,'y':0,'z':0},
  'cameraPos': {'x':0,'y':0,'z':20},
  'objects': [
    { 'type':'sphere',
      'center': {'x':-2,'y':0,'z':-10},
      'radius': 2.0,
      'colour': {'x':0,'y':255,'z':0}
    },
    { 'type':'sphere',
      'center': {'x':2,'y':0,'z':-10},
      'radius': 2.5,
      'colour': {'x':255,'y':0,'z':0}
    },
    { 'type':'sphere',
      'center': {'x':0,'y':-4,'z':-10},
      'radius': 3.0,
      'colour': {'x':0,'y':0,'z':255}
    },
    { 'type':'plane',
      'point': {'x':0,'y':0,'z':-12},
      'normal': {'x':0,'y':0,'z':1},
      'colour': {'x':255,'y':255,'z':255}
    }
  ],
}

function post(path, render) {
    var form = $('<form></form>');
    
    var data = {}
    data.waitsec = render;
    data.id = count++;
    console.log('render: '+render);
    
    var xhr = new XMLHttpRequest();
    xhr.open('post',path);
    xhr.setRequestHeader('Content-Type','application/json; charset=UTF-8');
    xhr.send(JSON.stringify(data));
    
    <!-- console.log('done: '+JSON.stringify(data, null, 2)); -->
    xhr.onloadend = function() {
      // done
    }
    console.log('POST sent: '+path);
}
var minVal = 1;
var maxVal = 3600;
function clickButton() {
  var num = parseInt(document.getElementById('submit-message').value);
  if (!$.isNumeric(num)) {
    console.log('Number not valid');
    return;
  }
  if (num < minVal || num > maxVal) {
    console.log('Number not in range');
    return;
  }
  <!-- post('ELB/busy',num); -->
  post('/busy',num);
  $('#submit-message').value = 1;
}
function renderExists(id) {
  var xhr = new XMLHttpRequest();
    xhr.open('get','/render');
    xhr.setRequestHeader('Content-Type','application/json; charset=UTF-8');
    xhr.send(JSON.stringify({'id':id}));
    
    <!-- console.log('done: '+JSON.stringify(data, null, 2)); -->
    xhr.onloadend = function() {
      // done
    }
    console.log('POST sent: '+path);
}
</script>
</head>
<body>
<h1>Busy-wait loader</h1>
<div id='submit'>
  <input type='number' id='submit-message' name='waitsec' />
  <button type='button' onclick='clickButton()'>Send</button>
</div>
<div id='console'>

</div>
<div id='images'>

</div>
</body>
</html>